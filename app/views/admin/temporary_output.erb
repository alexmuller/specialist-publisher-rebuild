<%= content_for :page_title, "Edit #{current_format.title} finder" %>

<% content_for :back_link, render_back_link(href: "/admin/#{current_format.admin_slug}") %>

<h1>Submit request for changes to <%= current_format.title %> finder</h1>

<div class="row">
  <div class="col-md-8">
    <p>Please visit <a href="https://support.publishing.service.gov.uk/changes_to_publishing_apps_request/new">Changes to publishing applications or technical advice</a> and copy and paste the "Proposed JSON" code for a developer to action. Ignore the other outputs below it, which are for debugging only.</p>
    <p>Longer term, we will eliminate this step and automatically raise a Zendesk ticket on your behalf.</p>

    <h2>Proposed JSON</h2>
    <pre><%= JSON.pretty_generate(@proposed_schema) %></pre>

    <hr />

    <h2>Diff</h2>
    <%= Diffy::Diff.new(
      JSON.pretty_generate(@original_schema).to_s,
      JSON.pretty_generate(@proposed_schema).to_s,
      allow_empty_diff: false,
    ).to_s(:html).html_safe %>

    <h2>Submitted params</h2>
    <pre><%= JSON.pretty_generate(@submitted_params) %></pre>

    <h2>Original JSON</h2>
    <pre><%= JSON.pretty_generate(@original_schema) %></pre>
  </div>
</div>
